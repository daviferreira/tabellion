"use strict";function capitalize(a){return a.charAt(0).toUpperCase()+a.substr(1)}var _createClass=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(exports,"__esModule",{value:!0});var Tabellion=exports.Tabellion=function(){function a(b){_classCallCheck(this,a),this.root=b}return _createClass(a,{root:{get:function(){return this._element},set:function(a){if(this._element=this._getDOMElement(a),!this._isTableElement())throw new Error("Element is not a table")}},addRow:{value:function(){var a=void 0===arguments[0]?-1:arguments[0],b=void 0===arguments[1]?void 0:arguments[1];return-1!==["above","below"].indexOf(a)&&(a="above"===a?this._getRowIndex(b):this._getRowIndex(b)+1),a=this._validateRowIndex(a),this._element.insertRow(a)}},deleteRow:{value:function(a){a=this._validateRowIndex(a),this._element.rows[a].parentNode.removeChild(this._element.rows[a])}},addColumn:{value:function(){var a=void 0===arguments[0]?-1:arguments[0],b=void 0===arguments[1]?void 0:arguments[1];-1!==["before","after"].indexOf(a)&&(a="before"===a?this._getColumnIndex(b):this._getColumnIndex(b)+1),a=this._validateColumnIndex(a);for(var c=[],d=0;d<this._element.rows.length;d++)c.push(this._element.rows[d].insertCell(a));return c}},deleteColumn:{value:function(a){a=this._validateColumnIndex(a);for(var b=0;b<this._element.rows.length;b++)this._element.rows[b].deleteCell(a)}},zebrify:{value:function(a){a=Object.assign({even:!1,className:"zebra"},a);for(var b=a.even?0:1,c=b;c<this._element.rows.length;c+=2)this._element.rows[c].classList.toggle(a.className)}},highlight:{value:function(a){var b=void 0===arguments[1]?"highlight":arguments[1];a=this._validateRowIndex(a),this._element.rows[a].classList.toggle(b)}},deleteTable:{value:function(){this._element.parentNode.removeChild(this._element)}},_getDOMElement:{value:function(a){return"string"==typeof a?document.body.querySelector(a):a}},_isTableElement:{value:function(){return this._element&&this._element.tagName&&"table"===this._element.tagName.toLowerCase()}},_validateRowIndex:{value:function(a){if(a=parseInt(Number(a),10),isNaN(a)||-1>a||a>this._element.rows.length)throw new Error("Invalid row index");return a}},_validateColumnIndex:{value:function(a){if(a=parseInt(Number(a),10),isNaN(a)||-1>a||a>this._element.rows[0].cells.length)throw new Error("Invalid column index");return a}},_getRowIndex:{value:function(a){this._validateElement(a,"tr","row");for(var b=0;b<this._element.rows.length;b+=1)if(this._element.rows[b]===a)return b}},_getColumnIndex:{value:function(a){this._validateElement(a,"td","column");for(var b=0;b<a.parentNode.cells.length;b+=1)if(a.parentNode.cells[b]===a)return b}},_validateElement:{value:function(a,b,c){if(b=b.toLowerCase(),!a||!a.tagName||a.tagName.toLowerCase()!==b)throw new Error("Invalid "+c+" element");this._validateChild(a,c)}},_validateChild:{value:function(a,b){if(!this._isDescendant(a))throw new Error(""+capitalize(b)+" is not a child of selected table")}},_isDescendant:{value:function(a){for(var b=a.parentNode;null!==b;){if(b===this._element)return!0;b=b.parentNode}return!1}}}),a}();
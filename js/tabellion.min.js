"use strict";function capitalize(a){return a.charAt(0).toUpperCase()+a.substr(1)}var _classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,d.value&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Tabellion=function(){function a(b){_classCallCheck(this,a),this.root=b}return _createClass(a,[{key:"root",get:function(){return this._element},set:function(a){if(this._element=this._getDOMElement(a),!this._isTableElement())throw new Error("Element is not a table")}},{key:"addRow",value:function(){var a=void 0===arguments[0]?{index:-1,cellContent:"<br />"}:arguments[0],b=a.index;-1!==["above","below"].indexOf(b)&&(b="above"===b?this._getRowIndex(a.target):this._getRowIndex(a.target)+1),b=this._validateRowIndex(b);for(var c=this._element.rows[0].cells.length,d=this._element.insertRow(b),e=0;c>e;e+=1){var f=d.insertCell(e);f.innerHTML=a.cellContent instanceof Array&&a.cellContent[e]?a.cellContent[e]:a.cellContent}return d}},{key:"deleteRow",value:function(a){a=this._validateRowIndex(a),this._element.rows[a].parentNode.removeChild(this._element.rows[a])}},{key:"addColumn",value:function(){var a=void 0===arguments[0]?{index:-1,content:"<br />"}:arguments[0],b=a.index;-1!==["before","after"].indexOf(b)&&(b="before"===b?this._getColumnIndex(a.target):this._getColumnIndex(a.target)+1),b=this._validateColumnIndex(b);for(var c=[],d=0;d<this._element.rows.length;d++){var e=this._element.rows[d].insertCell(b);e.innerHTML=a.content,c.push(e)}return c}},{key:"deleteColumn",value:function(a){a=this._validateColumnIndex(a);for(var b=0;b<this._element.rows.length;b++)this._element.rows[b].deleteCell(a)}},{key:"zebrify",value:function(a){a=Object.assign({even:!1,className:"zebra"},a);for(var b=a.even?0:1,c=b;c<this._element.rows.length;c+=2)this._element.rows[c].classList.toggle(a.className)}},{key:"highlight",value:function(a){var b=void 0===arguments[1]?"highlight":arguments[1];a=this._validateRowIndex(a),this._element.rows[a].classList.toggle(b)}},{key:"deleteTable",value:function(){this._element.parentNode.removeChild(this._element)}},{key:"_getDOMElement",value:function(a){return"string"==typeof a?document.body.querySelector(a):a}},{key:"_isTableElement",value:function(){return this._element&&this._element.tagName&&"table"===this._element.tagName.toLowerCase()}},{key:"_validateRowIndex",value:function(a){if(a=parseInt(Number(a),10),isNaN(a)||-1>a||a>this._element.rows.length)throw new Error("Invalid row index");return a}},{key:"_validateColumnIndex",value:function(a){if(a=parseInt(Number(a),10),isNaN(a)||-1>a||a>this._element.rows[0].cells.length)throw new Error("Invalid column index");return a}},{key:"_getRowIndex",value:function(a){this._validateElement(a,"tr","row");for(var b=0;b<this._element.rows.length;b+=1)if(this._element.rows[b]===a)return b}},{key:"_getColumnIndex",value:function(a){this._validateElement(a,"td","column");for(var b=0;b<a.parentNode.cells.length;b+=1)if(a.parentNode.cells[b]===a)return b}},{key:"_validateElement",value:function(a,b,c){if(b=b.toLowerCase(),!a||!a.tagName||a.tagName.toLowerCase()!==b)throw new Error("Invalid "+c+" element");this._validateChild(a,c)}},{key:"_validateChild",value:function(a,b){if(!this._isDescendant(a))throw new Error(""+capitalize(b)+" is not a child of selected table")}},{key:"_isDescendant",value:function(a){for(var b=a.parentNode;null!==b;){if(b===this._element)return!0;b=b.parentNode}return!1}}]),a}();